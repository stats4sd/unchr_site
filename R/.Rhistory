}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
script_download <- fromJSON(datasets_by_country$scripts_url[[0]])
return(script_download)
}
additional_info('IRQ')
script_download <- fromJSON(datasets_by_country$scripts_url[[1]])
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
script_download <- fromJSON(datasets_by_country$scripts_url[[1]])
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
script_download <- fromJSON(datasets_by_country$scripts_url[[1]])
datasets_by_country$scripts_url[[1]]
return(script_download)
}
additional_info('IRQ')
# script_download <- fromJSON(datasets_by_country$scripts_url[[1]])
print(datasets_by_country$scripts_url[[1]])
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
# script_download <- fromJSON(datasets_by_country$scripts_url[[1]])
print(datasets_by_country$scripts_url[[1]])
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
script_download <- fromJSON(as.json(datasets_by_country$scripts_url[[1]]))
#print(datasets_by_country$scripts_url[[1]])
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
script_download <- fromJSON((datasets_by_country$scripts_url[[1]]))
#print(datasets_by_country$scripts_url[[1]])
return(script_download)
}
additional_info('IRQ')
load_dataset<-function(country_code){
con <- get_sql_connection()
sql<-"SELECT *
FROM datasets
WHERE datasets.fake = 0
"
if(! is.null(country_code)) {
sql <- paste(sql, " AND datasets.country_code = '",country_code, "'", sep = "")
}
datasets <- dbGetQuery(con,paste(sql,";"))
datasets$countries_name <- as.factor(datasets$country_code)
datasets$year <- as.numeric(datasets$year)
datasets$region <- as.factor(datasets$region)
datasets$description <- as.factor(datasets$description)
datasets$population_definition <- as.factor(datasets$population_definition)
datasets$source_url <- as.factor(datasets$source_url)
# datasets$scripts_url <- as.factor(datasets$scripts_url)
datasets$comment <- as.factor(datasets$comment)
datasets$scripts_description <- as.factor(datasets$scripts_description)
dbDisconnect(con)
return(datasets)
}
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
script_download <- fromJSON((datasets_by_country$scripts_url[[1]]))
#print(datasets_by_country$scripts_url[[1]])
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for (scripts in datasets_by_country) {
script_download <- fromJSON(script_download <- fromJSON(scripts$scripts_url)
print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for (scripts in datasets_by_country) {
script_download <- fromJSON(scripts$scripts_url)
print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for (scripts in datasets_by_country) {
script_download <- fromJSON(scripts)
print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for (scripts in datasets_by_country) {
print(scripts)
script_download <- fromJSON(scripts$scripts_url)
print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for (scripts in datasets_by_country) {
print(scripts$scripts_url)
script_download <- fromJSON(scripts$scripts_url)
print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for (scripts in datasets_by_country) {
print(scripts$scripts_url)
script_download <- fromJSON(scripts$scripts_url)
print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for (id in datasets_by_country) {
print(datasets_by_country[id])
script_download <- fromJSON(datasets_by_country[id])
print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for (id in datasets_by_country) {
print(id)
#script_download <- fromJSON(datasets_by_country['sci'])
print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
#script_download <- fromJSON(datasets_by_country['sci'])
print(row)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
#script_download <- fromJSON(datasets_by_country['sci'])
print(row$scripts_url)
}
return(script_download)
}
additional_info('IRQ')
dditional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
script_download <- fromJSON(row$scripts_url)
print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
script_download <- fromJSON(row$scripts_url)
print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info('IRQ')
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row)){
script_download <- fromJSON(row$scripts_url)
}
#print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row$scripts_url)){
script_download <- fromJSON(row$scripts_url)
}
#print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row$scripts_url)){
script_download <- fromJSON(row$scripts_url)
for (i in 1:length(script_download)) {
print(script_download[i])
}
}
#print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
load_dot_env(file = "../.env")
Sys.getenv('APP_ENV')
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row$scripts_url)){
script_download <- fromJSON(row$scripts_url)
for (i in 1:length(script_download)) {
script_download<-paste(Sys.getenv('APP_ENV'),"storage/", script_download[i], sep = "")
print(script_download)
}
}
#print(script_download)
}
return(script_download)
additional_info<-function(country_code){
load_dot_env(file = "../.env")
Sys.getenv('APP_ENV')
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row$scripts_url)){
script_download <- fromJSON(row$scripts_url)
for (i in 1:length(script_download)) {
script_download<-paste(Sys.getenv('APP_ENV'),"storage/", script_download[i], sep = "")
print(script_download)
}
}
#print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info('IRQ')
additional_info<-function(country_code){
load_dot_env(file = "../.env")
Sys.getenv('APP_ENV')
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row$scripts_url)){
script_download <- fromJSON(row$scripts_url)
for (i in 1:length(script_download)) {
script_download<-paste(Sys.getenv('APP_ENV'),"storage/", script_download[i], sep = "")
print(script_download)
}
}
#print(script_download)
}
return(script_download)
}
additional_info<-function(country_code){
load_dot_env(file = "../.env")
Sys.getenv('APP_ENV')
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row$scripts_url)){
script_download <- fromJSON(row$scripts_url)
for (i in 1:length(script_download)) {
script_download<-paste(Sys.getenv('APP_ENV'),"storage/", script_download[i], sep = "")
print(script_download)
}
}
#print(script_download)
}
return(script_download)
}
additional_info('IRQ')
load_dot_env(file = "../.env")
Sys.getenv('APP_ENV')
exists()
;
xxz
ptorn
additional_info<-function(country_code){
load_dot_env(file = "../.env")
Sys.getenv('APP_ENV')
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row$scripts_url)){
script_download <- fromJSON(row$scripts_url)
for (i in 1:length(script_download)) {
script_download<-paste(Sys.getenv('APP_ENV'),"storage/", script_download[i], sep = "")
print(script_download)
}
}
#print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
load_dot_env(file = "../.env")
Sys.getenv('APP_ENV')
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row$scripts_url)){
script_download <- fromJSON(row$scripts_url)
for (i in 1:length(script_download)) {
script_download<-paste(Sys.getenv('APP_ENV'),"storage/", script_download[i], sep = "")
print(script_download)
}
}
#print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
load_dot_env(file = "../.env")
Sys.getenv('APP_ENV')
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row$scripts_url)){
script_download <- fromJSON(row$scripts_url)
for (i in 1:length(script_download)) {
script_download<-paste(Sys.getenv('APP_ENV'),"storage/", script_download[i], sep = "")
print(script_download)
}
}
#print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
load_dot_env(file = "../.env")
Sys.getenv('APP_ENV')
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row$scripts_url)){
script_download <- fromJSON(row$scripts_url)
for (i in 1:length(script_download)) {
script_download<-paste(Sys.getenv('APP_ENV'),"storage/", script_download[i], sep = "")
print(script_download)
}
}
#print(script_download)
}
return(script_download)
}
additional_info('IRQ')
additional_info<-function(country_code){
load_dot_env(file = "../.env")
Sys.getenv('APP_ENV')
datasets_by_country <- load_dataset(country_code)
for(i in 1:nrow(datasets_by_country)) {
row <- datasets_by_country[i,]
if(!is.na(row$scripts_url)){
script_download <- fromJSON(row$scripts_url)
for (i in 1:length(script_download)) {
script_download<-paste(Sys.getenv('APP_ENV'),"storage/", script_download[i], sep = "")
print(script_download)
}
}
#print(script_download)
}
return(script_download)
}
additional_info('IRQ')
source('~/GitHub/unhcr_site/R/data.R')
runApp()
runApp()
clearBounds()
clear()
stop()
script_url <- paste(Sys.getenv("APP_ENV"),storage,script,)
a("Example script", href=script_url, target="_blank")
#####################################
# download script for addtional info tab
#####################################
output$downloadScript <-  renderUI({
load_dot_env(file = "../.env")
Sys.getenv("APP_ENV")
script_url <- paste(Sys.getenv("APP_ENV"),storage,script,)
a("Example script", href=script_url, target="_blank")
})
#####################################
# refresh page when click on back to the map
#####################################
observe({
if (input$countrybar == "refresh") {
js$refresh();
}
})
#####################################
# load indicators and maps info
#####################################
observe({
req(input$country)
indicators <- load_indicators(input$country)
})
#####################################
# Info diplayed below Sdg image
#####################################
observe({
req(input$country)
indicators_country <- indicators_map %>% filter(country_code == input$country)
output$info_indicators <- renderUI({
HTML(paste0(
"<b>Number of Indicators Availble: </b>",indicators_country$indicator_num, "<br>",
"<b>Population Definitions: </b>",indicators_country$population_definition, "<br>",
"<br><b>Data sources: </b>", "<br>", indicators_country$source_url,
"<br>"
))
})
})
#####################################
# Info diplayed in Additional info Tab
#####################################
observe({
req(input$country)
datasets <- load_dataset(input$country)
output$additional_info <- renderUI({
HTML(paste0(
"<h4><b>",datasets$description,"</b></h4><br>",
"<h5><b>Population Definitions: </b>","<br></h5>","<a href=", datasets$source_url,">", datasets$source_url,"</a>","<br>",
"<h5><b>Comments: </b></h5>",datasets$comment, "<br>",
"<h5><b>Scripts Used: </b></h5>",datasets$scripts_url, "<br>",
"<hr>"
))
})
})
observe({
req(input$country)
indicators_country <- indicators_map %>% filter(country_code == input$country)
output$navbar_country <- renderUI({
HTML(paste0(
"<b>", toupper(indicators_country$countries_name), "</b>"
))
})
})
#####################################
# Images SDG
#####################################
observe({
req(input$country)
#clean the image sdg displayed
for (i in 1:16){
image_sdg_number <- paste("imageSdg",i, sep = "")
output[[image_sdg_number]] <- NULL
}
data_selected <- selectedData()
sdg_code<-unique(data_selected$sdg_code)
for(indicator in sdg_code){
sdg_number <- as.numeric(strsplit(indicator, ".", fixed = TRUE)[[1]][1])
image_sdg_number <- paste("imageSdg",sdg_number, sep = "")
output[[image_sdg_number]] <- show_image(sdg_number)
}
})
#download charts
output$downloadSDGByIndicator <- downloadHandler(
filename = "chartSDGbyIndicator.png",
content = function(file) {
device <- function(..., width, height) grDevices::png(..., width = width, height = height, res = 300, units = "in")
ggsave(file, plot = plotSdgByIndicator(), device = device)
}
)
output$downloadSDGBySubset <- downloadHandler(
filename = "chartSDGbySubset.png",
content = function(file) {
device <- function(..., width, height) grDevices::png(..., width = width, height = height, res = 300, units = "in")
ggsave(file, plot = plotSdgBySubset(), device = device)
}
)
# Create the map
output$mymap <- renderLeaflet({
leaflet() %>% addTiles( options = providerTileOptions(minZoom = 2, maxZoom = 10)) %>%
addProviderTiles("Esri.WorldStreetMap", options = providerTileOptions(minZoom = 2, maxZoom = 10))
})
runApp()
runApp()
runApp()
runApp()
